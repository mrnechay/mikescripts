#!/bin/bash

# your TURBOMOLE script (the one that runs on hoffman, calling ridft, etc.)
# Should look something like this:
# 
# genMFILE
# NumForce -ri -central -frznuclei -mfile MFILE > numforce.out
#
# Note the "-mfile MFILE"
# this makes NumForce looks for the mfile called MFILE, which is generated by this script
# That is why this script, genMFILE, is called first

if [ -a pehostfile ]; then rm pehostfile; fi
if [ -a MFILE ]; then rm MFILE; fi

cat $PE_HOSTFILE > pehostfile

linecount=`wc -l < pehostfile`

for ii in `seq $linecount`
do
numofcores=`cat pehostfile | head -n +$ii | tail -1 | awk -F" " '{print $2}'`
for jj in `seq $numofcores`
do
cat pehostfile | head -n +$ii | tail -1 | awk -F" " '{print $1}' >> MFILE
done
done
